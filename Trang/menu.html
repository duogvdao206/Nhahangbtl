<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ª±c ƒê∆°n</title>
    <link rel="stylesheet" href="/bootstrap-5.3.3-dist/css/bootstrap.css">
    <script src="bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
    <script src="JS/jquery-3.7.1.js"></script>
</head>
<style>
    .menutrangchu {
            width: 100%;
            margin: 50px auto;
            padding: 20px;
            background:rgba();
            border-radius: 10px;

        }
        /* CSS menu nh·ªè */
        .menu1 {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .menu1 button {
            padding: 10px 15px;
            font-size: 16px;
            background: #00000036;
            color: rgb(255, 255, 255);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            font-style: italic;
        }

        .menu1 button:hover {
            background: #ffffff;
            color: rgb(0, 0, 0);
        }

        /* Danh s√°ch m√≥n ƒÉn */
        .menu-items {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .menu-item {
            width: 250px;
            text-align: center;
            background: rgba(255, 255, 255, 0.273);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .menu-item:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.748);
        }

        .menu-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 10px;
        }

        .menu-item h3 {
            font-size: 18px;
            margin: 10px 0;
            color: #333;
            font-style: italic;
        }

        .menu-item p {
            font-size: 16px;
            color: #ff6600;
            font-weight: bold;
            font-style: italic;
        }

        .menu-item button {
            padding: 8px 15px;
            font-size: 14px;
            color: rgb(255, 255, 255);
            background: #000000a6;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .menu-item button:hover {
            background: #ffffff;
            color: #000000;
        }
        .giohag{
            margin-top: 20px;
            display: flex;
            padding-left: 100px;
        }
        .giohag h4{
            padding: 10px 10px;
            font-size: 1.6em;
            border-radius: 5px;
            margin-right: auto; /* ƒê·∫©y n√∫t sang ph·∫£i */
            color: white;
        }
        #tong{
            margin-top: 20px;
            display: flex;
            padding-left: 80%;

        }
        #btn1{
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background: #ff7700;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        #btn2{
            padding-left: 90%;
        }
</style>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Nh√† H√†ng</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="Trang/tranguser.html">Trang ch·ªß</a></li>
                    <li class="nav-item"><a class="nav-link" href="Trang/menu.html">Th·ª±c ƒë∆°n</a></li>
                    <li class="nav-item"><a class="nav-link" href="Trang/datban.html">ƒê·∫∑t b√†n</a></li>
                </ul>
                <form class="d-flex">
                    <input class="form-control me-2" type="search" placeholder="üîé T√¨m ki·∫øm m√≥n ƒÉn...">
                </form>
                <div class="auth-cart ms-3">
                    <a href="#" class="login text-decoration-none">ƒêƒÉng nh·∫≠p</a>
                    <button onclick="logout()" class="btn btn-outline-danger ms-2">ƒêƒÉng xu·∫•t</button>
                    <a href="Trang/menu.html" class="giohang text-decoration-none">üõí</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="menutrangchu mt-5 p-4">
        <h2 class="text-center fw-bold">Th·ª±c ƒë∆°n üî•</h2>
        <p class="text-center fst-italic fw-bold">ƒê·ªôc l·∫≠p t·ª± do, mi·∫øng n√†o to th√¨ g·∫Øp !</p>

        <!-- Menu Filter -->
        <div class="menu1 d-flex justify-content-center gap-3 mb-4">
            <button class="btn btn-outline-dark" onclick="showMenu('nuong')">M√≥n n∆∞·ªõng ü•ì</button>
            <button class="btn btn-outline-dark" onclick="showMenu('lau')">M√≥n l·∫©u üç≤</button>
            <button class="btn btn-outline-dark" onclick="showMenu('khai_vi')">M√≥n khai v·ªã üçπ</button>
        </div>

        <!-- Menu Items -->
        <div class="menu-items d-flex justify-content-center gap-4 flex-wrap" id="menu-container">
            <!-- M√≥n ƒÉn s·∫Ω thay ƒë·ªïi ·ªü ƒë√¢y -->
        </div>
    </div>
    <div class="giohag">
        <h4>Gi·ªè h√†ng :</h4>
    </div>
    <table class="bang table table-bordered table-striped">
        <thead class="table-light">
            <tr>
                <th>STT</th>
                <th>T√™n m√≥n</th>
                <th>Gi√°</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>Th√†nh ti·ªÅn</th>
                <th>X√≥a</th>
            </tr>
        </thead>
        <tbody>
            <!-- Danh s√°ch gi·ªè h√†ng s·∫Ω thay ƒë·ªïi ·ªü ƒë√¢y -->
        </tbody>
    </table>
    
    <div class="justify-content-end me-5">
        <a href="Trang/datban.html" id="btn2"><button class="btn btn-warning">ƒê·∫∑t B√†n</button></a>
    </div>
    <footer class="footer bg-light text-dark mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <h5 class="fw-bold">Nh√† H√†ng ABC</h5>
                    <p>Tr·∫£i nghi·ªám ·∫©m th·ª±c tuy·ªát v·ªùi v·ªõi nguy√™n li·ªáu t∆∞∆°i ngon & d·ªãch v·ª• chuy√™n nghi·ªáp.</p>
                </div>
                <div class="col-md-3">
                    <h6>V·ªÅ ch√∫ng t√¥i</h6>
                    <ul class="list-unstyled">
                        <li><a href="#">Gi·ªõi thi·ªáu</a></li>
                        <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                        <li><a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                        <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>H·ªó tr·ª£ kh√°ch h√†ng</h6>
                    <ul class="list-unstyled">
                        <li><a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
                        <li><a href="#">H∆∞·ªõng d·∫´n ƒë·∫∑t b√†n</a></li>
                        <li><a href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
                        <li><a href="#">Li√™n h·ªá</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i</h6>
                    <div class="d-flex gap-2">
                        <a href="#"><img src="https://img.icons8.com/?size=100&id=uLWV5A9vXIPu&format=png&color=000000" width="30"></a>
                        <a href="#"><img src="https://img.icons8.com/?size=100&id=BrU2BBoRXiWq&format=png&color=000000" width="30"></a>
                        <a href="#"><img src="https://img.icons8.com/?size=100&id=19318&format=png&color=000000" width="30"></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let username = localStorage.getItem("username");
            let loginLink = document.querySelector(".auth-cart .login");

            if (username) {
                loginLink.textContent = username; // Thay ch·ªØ "ƒêƒÉng nh·∫≠p" th√†nh username
                loginLink.href = "#"; // Kh√¥ng c·∫ßn chuy·ªÉn h∆∞·ªõng ƒë√¢u c·∫£
            } else {
                loginLink.href = "Trang/login.html"; // N·∫øu ch∆∞a ƒëƒÉng nh·∫≠p, quay l·∫°i trang login
            }
        });

        function logout() {
            localStorage.removeItem("username"); // X√≥a username kh·ªèi localStorage
            localStorage.removeItem("userId"); // X√≥a userId n·∫øu c√≥
            window.location.href = "Trang/login.html"; // Quay l·∫°i trang ƒëƒÉng nh·∫≠p
        }
        document.addEventListener("DOMContentLoaded", function () {
        let username = localStorage.getItem("username");

        if (!username) {
            alert("B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p tr∆∞·ªõc!");
            window.location.href = "Trang/login.html"; // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ƒëƒÉng nh·∫≠p
        }
    });
    $(document).ready(function () {
        function hienThiMenu(danhMuc = "all") {
            let danhSachMatHang = JSON.parse(localStorage.getItem("danhSachMatHang")) || [];
            let menuContainer = $("#menu-container");
            menuContainer.html("");

            let danhSachLoc = danhMuc === "all" ? danhSachMatHang : danhSachMatHang.filter(item => item.danhMuc === danhMuc);

            danhSachLoc.forEach(matHang => {
                let menuItem = `
                    <div class="menu-item">
                        <img src="${matHang.anh}" alt="${matHang.ten}">
                        <h3>${matHang.ten}</h3>
                        <p>${matHang.gia} ƒë</p>
                        <button onclick="addToCart('${matHang.ten}', '${matHang.gia}')">ƒê·∫∑t m√≥n</button>
                    </div>
                `;
                menuContainer.append(menuItem);
            });
        }

        // B·∫Øt s·ª± ki·ªán l·ªçc danh m·ª•c khi nh·∫•n n√∫t
        $(".menu1 button").click(function () {
            let danhMuc = $(this).attr("onclick").match(/showMenu\('(.+)'\)/)[1];
            hienThiMenu(danhMuc);
        });

        // C·∫≠p nh·∫≠t menu khi c√≥ thay ƒë·ªïi t·ª´ trang M·∫∑t h√†ng
        window.addEventListener("storage", function (event) {
            if (event.key === "danhSachMatHang") {
                hienThiMenu("all");
            }
        });

        // Hi·ªÉn th·ªã t·∫•t c·∫£ m√≥n ƒÉn khi t·∫£i trang
        hienThiMenu("all");
    });
        function showMenu(type) {
    const menuContainer = document.getElementById("menu-container");
    menuContainer.innerHTML = ""; // X√≥a menu c≈©

    menuData[type].forEach((item, index) => {
        const menuItem = document.createElement("div");
        menuItem.classList.add("menu-item");

        menuItem.innerHTML = `
            <img src="${item.img}" alt="${item.name}">
            <h3>${item.name}</h3>
            <p>${item.price}</p>
            <button class="order-button" onclick="addToCart('${item.name}', '${item.price}')">ƒê·∫∑t m√≥n</button>
        `;
        
        menuContainer.appendChild(menuItem);
    });
}
function addToCart(name, price) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    let found = cart.find(item => item.name === name);
    if (found) {
        found.quantity++;
    } else {
        cart.push({ name, price, quantity: 1 });
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("ƒê√£ th√™m v√†o gi·ªè h√†ng!");
}
function updateCartTableBody() {
    const cartTableBody = document.querySelector(".bang tbody");
    cartTableBody.innerHTML = ""; // X√≥a n·ªôi dung c≈©

    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    cart.forEach((item, index) => {
        let row = document.createElement("tr");
        row.innerHTML = `
            <td>${index + 1}</td>
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td>
                <button onclick="decreaseQuantity(${index})">-</button>
                ${item.quantity}
                <button onclick="increaseQuantity(${index})">+</button>
            </td>
            <td>${calculateTotal(item.price, item.quantity)}</td>
            <td><button onclick="removeFromCart(${index})">‚ùå</button></td>
        `;
        cartTableBody.appendChild(row);
    });

    // C·∫≠p nh·∫≠t t·ªïng ti·ªÅn
    const totalRow = document.createElement("tr");
    totalRow.innerHTML = `
        <td colspan="4" style="text-align: right;">T·ªïng c·ªông:</td>
        <td>${calculateCartTotal()}</td>
        <td></td>
    `;
    cartTableBody.appendChild(totalRow);
}

let cart = [];
function calculateTotal(price, quantity) {
    let numericPrice = parseInt(price.replace(/\D/g, "")); // Lo·∫°i b·ªè k√Ω t·ª± kh√¥ng ph·∫£i s·ªë
    return (numericPrice * quantity).toLocaleString() + "ƒë";
}

function calculateCartTotal() {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    let total = cart.reduce((sum, item) => {
        let numericPrice = parseInt(item.price.replace(/\D/g, ""));
        return sum + numericPrice * item.quantity;
    }, 0);
    return total.toLocaleString() + "ƒë";
}

function removeFromCart(index) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartTableBody();
}

function increaseQuantity(index) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart[index].quantity++;
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartTableBody();
}

function decreaseQuantity(index) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    if (cart[index].quantity > 1) {
        cart[index].quantity--;
    } else {
        cart.splice(index, 1);
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartTableBody();
}

function decreaseQuantity(index) {
    if (cart[index].quantity > 1) {
        cart[index].quantity--;
    } else {
        removeFromCart(index);
    }
    updateCartTableBody();
}
document.addEventListener("DOMContentLoaded", function () {
    updateCartTableBody();
});
$(document).ready(function () {
            function hienThiMenu() {
                let danhSachMatHang = JSON.parse(localStorage.getItem("danhSachMatHang")) || [];
                let menuContainer = $("#menu-container");
                menuContainer.html("");

                danhSachMatHang.forEach(matHang => {
                    let menuItem = `
                        <div class="menu-item">
                            <img src="${matHang.anh || matHang.img}" alt="${matHang.ten || matHang.name}">
                            <h3>${matHang.ten || matHang.name}</h3>
                            <p>${matHang.gia || matHang.price} ƒë</p>
                            <button onclick="addToCart('${matHang.ten || matHang.name}', '${matHang.gia || matHang.price}')">ƒê·∫∑t m√≥n</button>
                        </div>
                    `;
                    menuContainer.append(menuItem);
                });
            }

            window.addToCart = function (name, price) {
                let cart = JSON.parse(localStorage.getItem("cart")) || [];
                let found = cart.find(item => item.name === name);
                if (found) {
                    found.quantity++;
                } else {
                    cart.push({ name, price, quantity: 1 });
                }
                localStorage.setItem("cart", JSON.stringify(cart));
                alert("ƒê√£ th√™m v√†o gi·ªè h√†ng!");
            };

            function capNhatGioHang() {
                let cart = JSON.parse(localStorage.getItem("cart")) || [];
                console.log("C·∫≠p nh·∫≠t gi·ªè h√†ng: ", cart);
            }

            window.addEventListener("storage", function (event) {
                if (event.key === "danhSachMatHang") {
                    hienThiMenu();
                }
                if (event.key === "cart") {
                    capNhatGioHang();
                }
            });

            hienThiMenu();
        });
        function logout() {
            localStorage.removeItem("username");
            localStorage.removeItem("userId");
            window.location.href = "Trang/login.html";
        }
    </script>
</body>
</html>
